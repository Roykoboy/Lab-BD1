CREATE OR REPLACE FUNCTION update_order_total()
RETURNS TRIGGER AS $$
BEGIN
    -- Логика для обновления общей стоимости заказа
    UPDATE public."Orders"
    SET total_cost = (SELECT SUM(price * quantity) FROM public."OrderItems" WHERE order_id = NEW.id)
    WHERE id = NEW.id;

    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER order_total_update
AFTER INSERT OR UPDATE ON public."OrderItems"
FOR EACH ROW EXECUTE FUNCTION update_order_total();
